\addtocontents{xms}{\protect\addvspace{10pt}}
\chapter{Programes d'AplicaciÃ³ a l'ElectrotÃ¨cnia}\label{chap:python-programes}

\section{IntroducciÃ³}
\lstset{
	language=Python,
	numbers=left,
	frame=lines,
	morekeywords=[1]{as,None,match,case,with}
}

En aquest capÃ­tol es presenten dos mÃ²duls de Python amb funcions Ãºtils per resoldre problemes d'electrotÃ¨cnia; es llisten els  mÃ²duls i es donen petits exemples d'Ãºs. En el capÃ­tol \ref{chap:python-exemples} es fan servir aquests dos mÃ²duls per resoldre diversos exemples del llibre.

Per utilitzar aquests mÃ²duls cal crear una carpeta amb el nom \texttt{qed} i copiar-hi els tres fitxers, que es llistaran en les seccions segÃ¼ents: \texttt{\_\_init\_\_.py}, \texttt{utils.py} i \texttt{eng\_elc.py}. D'aquesta manera podrem accedir a les classes i funcions dels mÃ²duls qed.utils i qed.eng\_elc utilitzant la funciÃ³ \texttt{import} de Python.



\section{Fitxer d'inicialitzaciÃ³}
En el llistat \vref{lst:ini} es pot veure el contingut del fitxer d'inicialitzaciÃ³  \texttt{\_\_init\_\_.py}.

\lstinputlisting[caption={Python --- Fitxer \_\_init\_\_.py}, label=lst:ini]{Python/qed/\_\_init\_\_.py}

\section{MÃ²dul d'utilitats}
En el llistat \vref{lst:utils} es pot veure el llistat del fitxer \texttt{utils.py}, el qual contÃ© la implementaciÃ³ del mÃ²dul qed.utils.

\lstinputlisting[caption={Python --- Fitxer utils.py (mÃ²dul qed.utils)},label=lst:utils]{Python/qed/utils.py}

\section{MÃ²dul de funcions d'enginyeria elÃ¨ctrica}
En el llistat \vref{lst:eng-elec} es pot veure el llistat del fitxer \texttt{eng\_elec.py}, el qual contÃ© la implementaciÃ³ del mÃ²dul qed.eng\_elec.

\lstinputlisting[caption={Python --- Fitxer eng\_elec.py (mÃ²dul qed.eng\_elec)},label=lst:eng-elec]{Python/qed/eng_elec.py}

\lstset{
	language=Python,
	numbers=none,
	frame=none,
	morekeywords=[1]{as,None,match,case,with}
}

\section{Exemples}
Es donen a continuaciÃ³  exemples d'Ãºs d'algunes de les funcions d'aquests dos mÃ²duls. S'utilitzen tambÃ© funcions del mÃ²dul numÃ¨ric NumPy i del mÃ²dul grÃ fic matplotlib.

\begin{lstlisting}
>>> # Importem primer els mÃ²duls necessaris
>>> import numpy as np
>>> import matplotlib.pyplot as plt
>>> from qed.utils import ComplexD
>>> import qed.eng_elec as ee
\end{lstlisting} 


\begin{lstlisting}
>>> # Cable trifÃ sic de 25 mmÂ² de secciÃ³ i 100 m de longitud
>>> z=ee.z_cable(25, 100)
>>> print(f'Zcable = {z:.4f} Î©/fase = {ComplexD(z):.4f} Î©/fase')
Zcable = 0.0936+0.0107j Î©/fase = 0.0942âˆ 6.5215Â° Î©/fase	
\end{lstlisting} 

\begin{lstlisting}
>>> # Cable monofÃ sic de 25 mmÂ² de secciÃ³ i 100 m de longitud
>>> z=ee.z_cable(25, 2*100)
>>> print(f'Zcable = {z:.4f} Î©  = {ComplexD(z):.4f} Î©')
Zcable = 0.1872+0.0214j Î©  = 0.1884âˆ 6.5215Â° Î©	
\end{lstlisting}

\begin{lstlisting}
>>> # Cable de corrent continu de 25 mmÂ² de secciÃ³ i 100 m de longitud
>>> z=ee.z_cable(25, 2*100).real
>>> print(f'Zcable = {z:.4f} Î©')
Zcable = 0.1872 Î©	
\end{lstlisting}

\begin{lstlisting}
>>> # Sistema trifÃ sic: U=380 V fase-fase, I=200 A, cos ðœ‘=0.87. Cable: S=240 mmÂ², L=400 m
>>> cdt = ee.voltage_drop(380/np.sqrt(3), 200, ee.z_cable(240, 400), 0.87)
>>> print(f'Caiguda de tensiÃ³ = {cdt:.2f} V fase-neutre')
Caiguda de tensiÃ³ = 10.66 V fase-neutre
\end{lstlisting}

\begin{lstlisting}
>>> # Sistema monofÃ sic: U=220 V, I=55 A, cos ðœ‘=0.85. Cable: S=35 mmÂ², L=200 m
>>> cdt = ee.voltage_drop(220, 55, ee.z_cable(35, 2*200), 0.85)
>>> print(f'Caiguda de tensiÃ³ = {cdt:.2f} V')
Caiguda de tensiÃ³ = 13.85 V
\end{lstlisting}

\begin{lstlisting}
>>> # Sistema de corrent continu: U=125 V, I=25 A. Cable: S=16 mmÂ², L=50 m
>>> cdt = ee.voltage_drop(125, 25, ee.z_cable(16, 2*50).real)
>>> print(f'Caiguda de tensiÃ³ = {cdt:.2f} V')
Caiguda de tensiÃ³ = 3.68 V
\end{lstlisting}

	
\begin{lstlisting}
>>> # CÃ lcul d'impedÃ ncies sÃ¨rie i paraÅ€lel
>>> ee.z_series([1+1j, 1+1j, 1+1j])
(3+3j)
>>> ee.z_parallel([3+3j ,3+3j, 3+3j])
(1+1j)
\end{lstlisting}

\begin{lstlisting}
>>> # ResistÃ¨ncia unitÃ ria d'un fil de 0,5 mmÂ² de secciÃ³, a 90 Â°C 
>>> for material in ["Al", "Cu", "Ag", "Au"]:
. . .   res = ee.r_cable(0.5, 1, 90, material)
. . .   print(f'Material = {material}, ResistÃ¨ncia = {res:.4f} Î©/m')
Material = Al, ResistÃ¨ncia = 0.0720 Î©/m
Material = Cu, ResistÃ¨ncia = 0.0439 Î©/m
Material = Ag, ResistÃ¨ncia = 0.0417 Î©/m
Material = Au, ResistÃ¨ncia = 0.0604 Î©/m        
\end{lstlisting}

\begin{lstlisting}
>>> # Valors eficaÃ§ i mitjÃ  d'una ona senoidal semirectificada
>>> T = 20e-3  # 20 ms
>>> def f(t):
. . .   if t < T/2:
. . .       return 10*np.sin(2*np.pi/T*t)
. . .   else:
. . .       return 0
>>> ee.rms(f, 0, T)  # 10/2
5.0
>>> ee.average(f, 0, T)  # 10/Ï€
3.1830988618379064
\end{lstlisting}

\begin{lstlisting}
>>> # Valors eficaÃ§ i mitjÃ  d'una ona senoidal rectificada
>>> T = 20e-3  # 20 ms
>>> def f(t):
. . .   if t < T/2:
. . .       return 10*np.sin(2*np.pi/T*t)
. . .   else:
. . .       return -10*np.sin(2*np.pi/T*t)
>>> ee.rms(f, 0, T)  # 10/âˆš2
7.0710678118654755
>>> ee.average(f, 0, T)  # 2*10/Ï€
6.366197723675812
\end{lstlisting}

\begin{lstlisting}[mathescape=true]
>>> # ComparaciÃ³ de les corbes 51 'very inverse' CEI i IEEE
>>> I_p = 100 # A
>>> I_min = 1.05*I_p # A
>>> I_max = 5*I_p # A
>>> I = np.linspace(I_min, I_max, 200) # A
>>> t_CEI = ee.CEI_51_curve(I, "VI", I_p) # s   
>>> t_IEEE = ee.IEEE_51_curve(I, "VI", I_p) # s      
>>> fig, ax = plt.subplots(figsize=(6, 6))
>>> ax.grid(which='minor', alpha=0.2)
>>> ax.grid(which='major', alpha=0.9)
>>> ax.set(yscale="log")
>>> ax.set_ylim(1, 1000)
>>> ax.set_xlim(I_p, I_max)
>>> ax.plot(I, t_CEI, label="CEI")
>>> ax.plot(I, t_IEEE, label="IEEE")
>>> ax.set_title("Corbes 51 'very inverse'")
>>> ax.set_ylabel("Temps / s")
>>> ax.set_xlabel("Corrent / A")
>>> ax.legend(loc="upper right")
>>> plt.show()

$ \includegraphics{Cap-PythonProgs-corba51.pdf} $
\end{lstlisting}





